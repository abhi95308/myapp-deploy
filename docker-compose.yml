services:
  frontend:
    image: node:20-alpine
    working_dir: /app
    command: sh -c "npm install && node server.js"
    volumes:
      - ./frontend:/app
    environment:
      - PORT=3000
    labels:
      - "traefik.enable=true"
      - "traefik.docker.network=dokploy-network"
      - "traefik.http.routers.frontend.rule=Host(`app.54.206.49.116.nip.io`)"
      - "traefik.http.routers.frontend.entrypoints=web,websecure"
      - "traefik.http.routers.frontend.tls.certresolver=letsencrypt"
      - "traefik.http.services.frontend.loadbalancer.server.port=3000"
    networks:
      - dokploy-network

  api:
    image: node:20-alpine
    working_dir: /app
    command: sh -c "npm install && node server.js"
    volumes:
      - ./api:/app
    environment:
      - PORT=4000
    labels:
      - "traefik.enable=true"
      - "traefik.docker.network=dokploy-network"
      - "traefik.http.routers.api.rule=Host(`api.54.206.49.116.nip.io`)"
      - "traefik.http.routers.api.entrypoints=web,websecure"
      - "traefik.http.routers.api.tls.certresolver=letsencrypt"
      - "traefik.http.services.api.loadbalancer.server.port=4000"
    networks:
      - dokploy-network

networks:
  dokploy-network:
    external: true
