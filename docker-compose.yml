services:
  web:
    image: nginxdemos/hello:latest
    restart: always
    networks:
      - dokploy-network
    labels:
      - traefik.enable=true
      - traefik.docker.network=dokploy-network

      - traefik.http.routers.hello-web.rule=Host(`web.54.206.66.178.nip.io`)
      - traefik.http.routers.hello-web.entrypoints=web
      - traefik.http.routers.hello-web.middlewares=hello-redirecthttps@docker
      - traefik.http.routers.hello-web.service=hello-svc

      - traefik.http.routers.hello-websecure.rule=Host(`web.54.206.66.178.nip.io`)
      - traefik.http.routers.hello-websecure.entrypoints=websecure
      - traefik.http.routers.hello-websecure.tls.certresolver=letsencrypt
      - traefik.http.routers.hello-websecure.service=hello-svc

      - traefik.http.services.hello-svc.loadbalancer.server.port=80

      - traefik.http.middlewares.hello-redirecthttps.redirectscheme.scheme=https
      - traefik.http.middlewares.hello-redirecthttps.redirectscheme.permanent=true

networks:
  dokploy-network:
    external: true
